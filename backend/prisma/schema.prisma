// backend/prisma/schema.prisma
// Database schema defining User, TelegramAccount, and TelegramSession models

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id             String            @id @default(cuid())
  email          String            @unique
  passwordHash   String
  displayName    String?
  createdAt      DateTime          @default(now())
  isLoggedIn     Boolean  @default(false) 
  telegramAccounts TelegramAccount[]
}

model TelegramAccount {
  id          String   @id @default(cuid())
  userId      String
  telegramId  String   @unique       
  phoneNumber String?
  username    String?
  firstName   String?
  lastName    String?
  isActive    Boolean  @default(false) 
  createdAt   DateTime @default(now())
  user        User     @relation(fields: [userId], references: [id])
  session     TelegramSession?
}

model TelegramSession {
  id            String   @id @default(cuid())
  accountId     String   @unique
  sessionString String  
  createdAt     DateTime @default(now())
  account       TelegramAccount @relation(fields: [accountId], references: [id], onDelete: Cascade)
}
